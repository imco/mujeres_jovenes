(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))e(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();class pt{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const i=this._partials;let e=0;for(let a=0;a<this._n&&a<32;a++){const o=i[a],r=n+o,c=Math.abs(n)<Math.abs(o)?n-(r-o):o-(r-n);c&&(i[e++]=c),n=r}return i[e]=n,this._n=e+1,this}valueOf(){const n=this._partials;let i=this._n,e,a,o,r=0;if(i>0){for(r=n[--i];i>0&&(e=r,a=n[--i],r=e+a,o=a-(r-e),!o););i>0&&(o<0&&n[i-1]<0||o>0&&n[i-1]>0)&&(a=o*2,e=r+a,a==e-r&&(r=e))}return r}}function*Ae(t){for(const n of t)yield*n}function Jn(t){return Array.from(Ae(t))}var R=1e-6,F=Math.PI,J=F/2,An=F/4,tt=F*2,Z=180/F,V=F/180,P=Math.abs,Zn=Math.atan,kt=Math.atan2,O=Math.cos,_e=Math.exp,ke=Math.log,B=Math.sin,Te=Math.sign||function(t){return t>0?1:t<0?-1:0},ht=Math.sqrt,Ce=Math.tan;function ze(t){return t>1?0:t<-1?F:Math.acos(t)}function Tt(t){return t>1?J:t<-1?-J:Math.asin(t)}function it(){}function Vt(t,n){t&&kn.hasOwnProperty(t.type)&&kn[t.type](t,n)}var _n={Feature:function(t,n){Vt(t.geometry,n)},FeatureCollection:function(t,n){for(var i=t.features,e=-1,a=i.length;++e<a;)Vt(i[e].geometry,n)}},kn={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var i=t.coordinates,e=-1,a=i.length;++e<a;)t=i[e],n.point(t[0],t[1],t[2])},LineString:function(t,n){rn(t.coordinates,n,0)},MultiLineString:function(t,n){for(var i=t.coordinates,e=-1,a=i.length;++e<a;)rn(i[e],n,0)},Polygon:function(t,n){Tn(t.coordinates,n)},MultiPolygon:function(t,n){for(var i=t.coordinates,e=-1,a=i.length;++e<a;)Tn(i[e],n)},GeometryCollection:function(t,n){for(var i=t.geometries,e=-1,a=i.length;++e<a;)Vt(i[e],n)}};function rn(t,n,i){var e=-1,a=t.length-i,o;for(n.lineStart();++e<a;)o=t[e],n.point(o[0],o[1],o[2]);n.lineEnd()}function Tn(t,n){var i=-1,e=t.length;for(n.polygonStart();++i<e;)rn(t[i],n,1);n.polygonEnd()}function mt(t,n){t&&_n.hasOwnProperty(t.type)?_n[t.type](t,n):Vt(t,n)}function sn(t){return[kt(t[1],t[0]),Tt(t[2])]}function gt(t){var n=t[0],i=t[1],e=O(i);return[e*O(n),e*B(n),B(i)]}function Ft(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Dt(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function nn(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Rt(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function ln(t){var n=ht(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function cn(t,n){function i(e,a){return e=t(e,a),n(e[0],e[1])}return t.invert&&n.invert&&(i.invert=function(e,a){return e=n.invert(e,a),e&&t.invert(e[0],e[1])}),i}function un(t,n){return P(t)>F&&(t-=Math.round(t/tt)*tt),[t,n]}un.invert=un;function te(t,n,i){return(t%=tt)?n||i?cn(zn(t),Hn(n,i)):zn(t):n||i?Hn(n,i):un}function Cn(t){return function(n,i){return n+=t,P(n)>F&&(n-=Math.round(n/tt)*tt),[n,i]}}function zn(t){var n=Cn(t);return n.invert=Cn(-t),n}function Hn(t,n){var i=O(t),e=B(t),a=O(n),o=B(n);function r(c,m){var d=O(m),s=O(c)*d,u=B(c)*d,l=B(m),p=l*i+s*e;return[kt(u*a-p*o,s*i-l*e),Tt(p*a+u*o)]}return r.invert=function(c,m){var d=O(m),s=O(c)*d,u=B(c)*d,l=B(m),p=l*a-u*o;return[kt(u*a+l*o,s*i+p*e),Tt(p*i-s*e)]},r}function He(t){t=te(t[0]*V,t[1]*V,t.length>2?t[2]*V:0);function n(i){return i=t(i[0]*V,i[1]*V),i[0]*=Z,i[1]*=Z,i}return n.invert=function(i){return i=t.invert(i[0]*V,i[1]*V),i[0]*=Z,i[1]*=Z,i},n}function Ie(t,n,i,e,a,o){if(i){var r=O(n),c=B(n),m=e*i;a==null?(a=n+e*tt,o=n-m/2):(a=In(r,a),o=In(r,o),(e>0?a<o:a>o)&&(a+=e*tt));for(var d,s=a;e>0?s>o:s<o;s-=m)d=sn([r,-c*O(s),-c*B(s)]),t.point(d[0],d[1])}}function In(t,n){n=gt(n),n[0]-=t,ln(n);var i=ze(-n[1]);return((-n[2]<0?-i:i)+tt-R)%tt}function ne(){var t=[],n;return{point:function(i,e,a){n.push([i,e,a])},lineStart:function(){t.push(n=[])},lineEnd:it,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var i=t;return t=[],n=null,i}}}function Ot(t,n){return P(t[0]-n[0])<R&&P(t[1]-n[1])<R}function Pt(t,n,i,e){this.x=t,this.z=n,this.o=i,this.e=e,this.v=!1,this.n=this.p=null}function ee(t,n,i,e,a){var o=[],r=[],c,m;if(t.forEach(function(f){if(!((S=f.length-1)<=0)){var S,g=f[0],L=f[S],v;if(Ot(g,L)){if(!g[2]&&!L[2]){for(a.lineStart(),c=0;c<S;++c)a.point((g=f[c])[0],g[1]);a.lineEnd();return}L[0]+=2*R}o.push(v=new Pt(g,f,null,!0)),r.push(v.o=new Pt(g,null,v,!1)),o.push(v=new Pt(L,f,null,!1)),r.push(v.o=new Pt(L,null,v,!0))}}),!!o.length){for(r.sort(n),Fn(o),Fn(r),c=0,m=r.length;c<m;++c)r[c].e=i=!i;for(var d=o[0],s,u;;){for(var l=d,p=!0;l.v;)if((l=l.n)===d)return;s=l.z,a.lineStart();do{if(l.v=l.o.v=!0,l.e){if(p)for(c=0,m=s.length;c<m;++c)a.point((u=s[c])[0],u[1]);else e(l.x,l.n.x,1,a);l=l.n}else{if(p)for(s=l.p.z,c=s.length-1;c>=0;--c)a.point((u=s[c])[0],u[1]);else e(l.x,l.p.x,-1,a);l=l.p}l=l.o,s=l.z,p=!p}while(!l.v);a.lineEnd()}}}function Fn(t){if(n=t.length){for(var n,i=0,e=t[0],a;++i<n;)e.n=a=t[i],a.p=e,e=a;e.n=a=t[0],a.p=e}}function en(t){return P(t[0])<=F?t[0]:Te(t[0])*((P(t[0])+F)%tt-F)}function Fe(t,n){var i=en(n),e=n[1],a=B(e),o=[B(i),-O(i),0],r=0,c=0,m=new pt;a===1?e=J+R:a===-1&&(e=-J-R);for(var d=0,s=t.length;d<s;++d)if(l=(u=t[d]).length)for(var u,l,p=u[l-1],f=en(p),S=p[1]/2+An,g=B(S),L=O(S),v=0;v<l;++v,f=$,g=b,L=T,p=y){var y=u[v],$=en(y),N=y[1]/2+An,b=B(N),T=O(N),C=$-f,M=C>=0?1:-1,A=M*C,E=A>F,k=g*b;if(m.add(kt(k*M*B(A),L*T+k*O(A))),r+=E?C+M*tt:C,E^f>=i^$>=i){var w=Dt(gt(p),gt(y));ln(w);var z=Dt(o,w);ln(z);var h=(E^C>=0?-1:1)*Tt(z[2]);(e>h||e===h&&(w[0]||w[1]))&&(c+=E^C>=0?1:-1)}}return(r<-R||r<R&&m<-1e-12)^c&1}function ie(t,n,i,e){return function(a){var o=n(a),r=ne(),c=n(r),m=!1,d,s,u,l={point:p,lineStart:S,lineEnd:g,polygonStart:function(){l.point=L,l.lineStart=v,l.lineEnd=y,s=[],d=[]},polygonEnd:function(){l.point=p,l.lineStart=S,l.lineEnd=g,s=Jn(s);var $=Fe(d,e);s.length?(m||(a.polygonStart(),m=!0),ee(s,Pe,$,i,a)):$&&(m||(a.polygonStart(),m=!0),a.lineStart(),i(null,null,1,a),a.lineEnd()),m&&(a.polygonEnd(),m=!1),s=d=null},sphere:function(){a.polygonStart(),a.lineStart(),i(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function p($,N){t($,N)&&a.point($,N)}function f($,N){o.point($,N)}function S(){l.point=f,o.lineStart()}function g(){l.point=p,o.lineEnd()}function L($,N){u.push([$,N]),c.point($,N)}function v(){c.lineStart(),u=[]}function y(){L(u[0][0],u[0][1]),c.lineEnd();var $=c.clean(),N=r.result(),b,T=N.length,C,M,A;if(u.pop(),d.push(u),u=null,!!T){if($&1){if(M=N[0],(C=M.length-1)>0){for(m||(a.polygonStart(),m=!0),a.lineStart(),b=0;b<C;++b)a.point((A=M[b])[0],A[1]);a.lineEnd()}return}T>1&&$&2&&N.push(N.pop().concat(N.shift())),s.push(N.filter(Re))}}return l}}function Re(t){return t.length>1}function Pe(t,n){return((t=t.x)[0]<0?t[1]-J-R:J-t[1])-((n=n.x)[0]<0?n[1]-J-R:J-n[1])}const Rn=ie(function(){return!0},qe,Oe,[-F,-J]);function qe(t){var n=NaN,i=NaN,e=NaN,a;return{lineStart:function(){t.lineStart(),a=1},point:function(o,r){var c=o>0?F:-F,m=P(o-n);P(m-F)<R?(t.point(n,i=(i+r)/2>0?J:-J),t.point(e,i),t.lineEnd(),t.lineStart(),t.point(c,i),t.point(o,i),a=0):e!==c&&m>=F&&(P(n-e)<R&&(n-=e*R),P(o-c)<R&&(o-=c*R),i=je(n,i,o,r),t.point(e,i),t.lineEnd(),t.lineStart(),t.point(c,i),a=0),t.point(n=o,i=r),e=c},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-a}}}function je(t,n,i,e){var a,o,r=B(t-i);return P(r)>R?Zn((B(n)*(o=O(e))*B(i)-B(e)*(a=O(n))*B(t))/(a*o*r)):(n+e)/2}function Oe(t,n,i,e){var a;if(t==null)a=i*J,e.point(-F,a),e.point(0,a),e.point(F,a),e.point(F,0),e.point(F,-a),e.point(0,-a),e.point(-F,-a),e.point(-F,0),e.point(-F,a);else if(P(t[0]-n[0])>R){var o=t[0]<n[0]?F:-F;a=i*o/2,e.point(-o,a),e.point(0,a),e.point(o,a)}else e.point(n[0],n[1])}function Be(t){var n=O(t),i=2*V,e=n>0,a=P(n)>R;function o(s,u,l,p){Ie(p,t,i,l,s,u)}function r(s,u){return O(s)*O(u)>n}function c(s){var u,l,p,f,S;return{lineStart:function(){f=p=!1,S=1},point:function(g,L){var v=[g,L],y,$=r(g,L),N=e?$?0:d(g,L):$?d(g+(g<0?F:-F),L):0;if(!u&&(f=p=$)&&s.lineStart(),$!==p&&(y=m(u,v),(!y||Ot(u,y)||Ot(v,y))&&(v[2]=1)),$!==p)S=0,$?(s.lineStart(),y=m(v,u),s.point(y[0],y[1])):(y=m(u,v),s.point(y[0],y[1],2),s.lineEnd()),u=y;else if(a&&u&&e^$){var b;!(N&l)&&(b=m(v,u,!0))&&(S=0,e?(s.lineStart(),s.point(b[0][0],b[0][1]),s.point(b[1][0],b[1][1]),s.lineEnd()):(s.point(b[1][0],b[1][1]),s.lineEnd(),s.lineStart(),s.point(b[0][0],b[0][1],3)))}$&&(!u||!Ot(u,v))&&s.point(v[0],v[1]),u=v,p=$,l=N},lineEnd:function(){p&&s.lineEnd(),u=null},clean:function(){return S|(f&&p)<<1}}}function m(s,u,l){var p=gt(s),f=gt(u),S=[1,0,0],g=Dt(p,f),L=Ft(g,g),v=g[0],y=L-v*v;if(!y)return!l&&s;var $=n*L/y,N=-n*v/y,b=Dt(S,g),T=Rt(S,$),C=Rt(g,N);nn(T,C);var M=b,A=Ft(T,M),E=Ft(M,M),k=A*A-E*(Ft(T,T)-1);if(!(k<0)){var w=ht(k),z=Rt(M,(-A-w)/E);if(nn(z,T),z=sn(z),!l)return z;var h=s[0],H=u[0],q=s[1],G=u[1],X;H<h&&(X=h,h=H,H=X);var nt=H-h,D=P(nt-F)<R,U=D||nt<R;if(!D&&G<q&&(X=q,q=G,G=X),U?D?q+G>0^z[1]<(P(z[0]-h)<R?q:G):q<=z[1]&&z[1]<=G:nt>F^(h<=z[0]&&z[0]<=H)){var W=Rt(M,(-A+w)/E);return nn(W,T),[z,sn(W)]}}}function d(s,u){var l=e?t:F-t,p=0;return s<-l?p|=1:s>l&&(p|=2),u<-l?p|=4:u>l&&(p|=8),p}return ie(r,c,o,e?[0,-t]:[-F,t-F])}function Ve(t,n,i,e,a,o){var r=t[0],c=t[1],m=n[0],d=n[1],s=0,u=1,l=m-r,p=d-c,f;if(f=i-r,!(!l&&f>0)){if(f/=l,l<0){if(f<s)return;f<u&&(u=f)}else if(l>0){if(f>u)return;f>s&&(s=f)}if(f=a-r,!(!l&&f<0)){if(f/=l,l<0){if(f>u)return;f>s&&(s=f)}else if(l>0){if(f<s)return;f<u&&(u=f)}if(f=e-c,!(!p&&f>0)){if(f/=p,p<0){if(f<s)return;f<u&&(u=f)}else if(p>0){if(f>u)return;f>s&&(s=f)}if(f=o-c,!(!p&&f<0)){if(f/=p,p<0){if(f>u)return;f>s&&(s=f)}else if(p>0){if(f<s)return;f<u&&(u=f)}return s>0&&(t[0]=r+s*l,t[1]=c+s*p),u<1&&(n[0]=r+u*l,n[1]=c+u*p),!0}}}}}var xt=1e9,qt=-xt;function De(t,n,i,e){function a(d,s){return t<=d&&d<=i&&n<=s&&s<=e}function o(d,s,u,l){var p=0,f=0;if(d==null||(p=r(d,u))!==(f=r(s,u))||m(d,s)<0^u>0)do l.point(p===0||p===3?t:i,p>1?e:n);while((p=(p+u+4)%4)!==f);else l.point(s[0],s[1])}function r(d,s){return P(d[0]-t)<R?s>0?0:3:P(d[0]-i)<R?s>0?2:1:P(d[1]-n)<R?s>0?1:0:s>0?3:2}function c(d,s){return m(d.x,s.x)}function m(d,s){var u=r(d,1),l=r(s,1);return u!==l?u-l:u===0?s[1]-d[1]:u===1?d[0]-s[0]:u===2?d[1]-s[1]:s[0]-d[0]}return function(d){var s=d,u=ne(),l,p,f,S,g,L,v,y,$,N,b,T={point:C,lineStart:k,lineEnd:w,polygonStart:A,polygonEnd:E};function C(h,H){a(h,H)&&s.point(h,H)}function M(){for(var h=0,H=0,q=p.length;H<q;++H)for(var G=p[H],X=1,nt=G.length,D=G[0],U,W,st=D[0],at=D[1];X<nt;++X)U=st,W=at,D=G[X],st=D[0],at=D[1],W<=e?at>e&&(st-U)*(e-W)>(at-W)*(t-U)&&++h:at<=e&&(st-U)*(e-W)<(at-W)*(t-U)&&--h;return h}function A(){s=u,l=[],p=[],b=!0}function E(){var h=M(),H=b&&h,q=(l=Jn(l)).length;(H||q)&&(d.polygonStart(),H&&(d.lineStart(),o(null,null,1,d),d.lineEnd()),q&&ee(l,c,h,o,d),d.polygonEnd()),s=d,l=p=f=null}function k(){T.point=z,p&&p.push(f=[]),N=!0,$=!1,v=y=NaN}function w(){l&&(z(S,g),L&&$&&u.rejoin(),l.push(u.result())),T.point=C,$&&s.lineEnd()}function z(h,H){var q=a(h,H);if(p&&f.push([h,H]),N)S=h,g=H,L=q,N=!1,q&&(s.lineStart(),s.point(h,H));else if(q&&$)s.point(h,H);else{var G=[v=Math.max(qt,Math.min(xt,v)),y=Math.max(qt,Math.min(xt,y))],X=[h=Math.max(qt,Math.min(xt,h)),H=Math.max(qt,Math.min(xt,H))];Ve(G,X,t,n,i,e)?($||(s.lineStart(),s.point(G[0],G[1])),s.point(X[0],X[1]),q||s.lineEnd(),b=!1):q&&(s.lineStart(),s.point(h,H),b=!1)}v=h,y=H,$=q}return T}}const dn=t=>t;var an=new pt,pn=new pt,ae,oe,fn,hn,lt={point:it,lineStart:it,lineEnd:it,polygonStart:function(){lt.lineStart=Ge,lt.lineEnd=Ue},polygonEnd:function(){lt.lineStart=lt.lineEnd=lt.point=it,an.add(P(pn)),pn=new pt},result:function(){var t=an/2;return an=new pt,t}};function Ge(){lt.point=Xe}function Xe(t,n){lt.point=re,ae=fn=t,oe=hn=n}function re(t,n){pn.add(hn*t-fn*n),fn=t,hn=n}function Ue(){re(ae,oe)}var yt=1/0,Gt=yt,Ct=-yt,Xt=Ct,Ut={point:We,lineStart:it,lineEnd:it,polygonStart:it,polygonEnd:it,result:function(){var t=[[yt,Gt],[Ct,Xt]];return Ct=Xt=-(Gt=yt=1/0),t}};function We(t,n){t<yt&&(yt=t),t>Ct&&(Ct=t),n<Gt&&(Gt=n),n>Xt&&(Xt=n)}var mn=0,vn=0,Mt=0,Wt=0,Yt=0,vt=0,gn=0,yn=0,Lt=0,se,le,ot,rt,et={point:ft,lineStart:Pn,lineEnd:qn,polygonStart:function(){et.lineStart=Qe,et.lineEnd=Je},polygonEnd:function(){et.point=ft,et.lineStart=Pn,et.lineEnd=qn},result:function(){var t=Lt?[gn/Lt,yn/Lt]:vt?[Wt/vt,Yt/vt]:Mt?[mn/Mt,vn/Mt]:[NaN,NaN];return mn=vn=Mt=Wt=Yt=vt=gn=yn=Lt=0,t}};function ft(t,n){mn+=t,vn+=n,++Mt}function Pn(){et.point=Ye}function Ye(t,n){et.point=Ke,ft(ot=t,rt=n)}function Ke(t,n){var i=t-ot,e=n-rt,a=ht(i*i+e*e);Wt+=a*(ot+t)/2,Yt+=a*(rt+n)/2,vt+=a,ft(ot=t,rt=n)}function qn(){et.point=ft}function Qe(){et.point=Ze}function Je(){ce(se,le)}function Ze(t,n){et.point=ce,ft(se=ot=t,le=rt=n)}function ce(t,n){var i=t-ot,e=n-rt,a=ht(i*i+e*e);Wt+=a*(ot+t)/2,Yt+=a*(rt+n)/2,vt+=a,a=rt*t-ot*n,gn+=a*(ot+t),yn+=a*(rt+n),Lt+=a*3,ft(ot=t,rt=n)}function ue(t){this._context=t}ue.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:{this._context.moveTo(t,n),this._point=1;break}case 1:{this._context.lineTo(t,n);break}default:{this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,tt);break}}},result:it};var bn=new pt,on,de,pe,Nt,At,zt={point:it,lineStart:function(){zt.point=ti},lineEnd:function(){on&&fe(de,pe),zt.point=it},polygonStart:function(){on=!0},polygonEnd:function(){on=null},result:function(){var t=+bn;return bn=new pt,t}};function ti(t,n){zt.point=fe,de=Nt=t,pe=At=n}function fe(t,n){Nt-=t,At-=n,bn.add(ht(Nt*Nt+At*At)),Nt=t,At=n}let jn,Kt,On,Bn;class Vn{constructor(n){this._append=n==null?he:ni(n),this._radius=4.5,this._=""}pointRadius(n){return this._radius=+n,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(n,i){switch(this._point){case 0:{this._append`M${n},${i}`,this._point=1;break}case 1:{this._append`L${n},${i}`;break}default:{if(this._append`M${n},${i}`,this._radius!==On||this._append!==Kt){const e=this._radius,a=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,On=e,Kt=this._append,Bn=this._,this._=a}this._+=Bn;break}}}result(){const n=this._;return this._="",n.length?n:null}}function he(t){let n=1;this._+=t[0];for(const i=t.length;n<i;++n)this._+=arguments[n]+t[n]}function ni(t){const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);if(n>15)return he;if(n!==jn){const i=10**n;jn=n,Kt=function(a){let o=1;this._+=a[0];for(const r=a.length;o<r;++o)this._+=Math.round(arguments[o]*i)/i+a[o]}}return Kt}function En(t,n){let i=3,e=4.5,a,o;function r(c){return c&&(typeof e=="function"&&o.pointRadius(+e.apply(this,arguments)),mt(c,a(o))),o.result()}return r.area=function(c){return mt(c,a(lt)),lt.result()},r.measure=function(c){return mt(c,a(zt)),zt.result()},r.bounds=function(c){return mt(c,a(Ut)),Ut.result()},r.centroid=function(c){return mt(c,a(et)),et.result()},r.projection=function(c){return arguments.length?(a=c==null?(t=null,dn):(t=c).stream,r):t},r.context=function(c){return arguments.length?(o=c==null?(n=null,new Vn(i)):new ue(n=c),typeof e!="function"&&o.pointRadius(e),r):n},r.pointRadius=function(c){return arguments.length?(e=typeof c=="function"?c:(o.pointRadius(+c),+c),r):e},r.digits=function(c){if(!arguments.length)return i;if(c==null)i=null;else{const m=Math.floor(c);if(!(m>=0))throw new RangeError(`invalid digits: ${c}`);i=m}return n===null&&(o=new Vn(i)),r},r.projection(t).digits(i).context(n)}function wn(t){return function(n){var i=new $n;for(var e in t)i[e]=t[e];return i.stream=n,i}}function $n(){}$n.prototype={constructor:$n,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function xn(t,n,i){var e=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),e!=null&&t.clipExtent(null),mt(i,t.stream(Ut)),n(Ut.result()),e!=null&&t.clipExtent(e),t}function me(t,n,i){return xn(t,function(e){var a=n[1][0]-n[0][0],o=n[1][1]-n[0][1],r=Math.min(a/(e[1][0]-e[0][0]),o/(e[1][1]-e[0][1])),c=+n[0][0]+(a-r*(e[1][0]+e[0][0]))/2,m=+n[0][1]+(o-r*(e[1][1]+e[0][1]))/2;t.scale(150*r).translate([c,m])},i)}function ei(t,n,i){return me(t,[[0,0],n],i)}function ii(t,n,i){return xn(t,function(e){var a=+n,o=a/(e[1][0]-e[0][0]),r=(a-o*(e[1][0]+e[0][0]))/2,c=-o*e[0][1];t.scale(150*o).translate([r,c])},i)}function ai(t,n,i){return xn(t,function(e){var a=+n,o=a/(e[1][1]-e[0][1]),r=-o*e[0][0],c=(a-o*(e[1][1]+e[0][1]))/2;t.scale(150*o).translate([r,c])},i)}var Dn=16,oi=O(30*V);function Gn(t,n){return+n?si(t,n):ri(t)}function ri(t){return wn({point:function(n,i){n=t(n,i),this.stream.point(n[0],n[1])}})}function si(t,n){function i(e,a,o,r,c,m,d,s,u,l,p,f,S,g){var L=d-e,v=s-a,y=L*L+v*v;if(y>4*n&&S--){var $=r+l,N=c+p,b=m+f,T=ht($*$+N*N+b*b),C=Tt(b/=T),M=P(P(b)-1)<R||P(o-u)<R?(o+u)/2:kt(N,$),A=t(M,C),E=A[0],k=A[1],w=E-e,z=k-a,h=v*w-L*z;(h*h/y>n||P((L*w+v*z)/y-.5)>.3||r*l+c*p+m*f<oi)&&(i(e,a,o,r,c,m,E,k,M,$/=T,N/=T,b,S,g),g.point(E,k),i(E,k,M,$,N,b,d,s,u,l,p,f,S,g))}}return function(e){var a,o,r,c,m,d,s,u,l,p,f,S,g={point:L,lineStart:v,lineEnd:$,polygonStart:function(){e.polygonStart(),g.lineStart=N},polygonEnd:function(){e.polygonEnd(),g.lineStart=v}};function L(C,M){C=t(C,M),e.point(C[0],C[1])}function v(){u=NaN,g.point=y,e.lineStart()}function y(C,M){var A=gt([C,M]),E=t(C,M);i(u,l,s,p,f,S,u=E[0],l=E[1],s=C,p=A[0],f=A[1],S=A[2],Dn,e),e.point(u,l)}function $(){g.point=L,e.lineEnd()}function N(){v(),g.point=b,g.lineEnd=T}function b(C,M){y(a=C,M),o=u,r=l,c=p,m=f,d=S,g.point=y}function T(){i(u,l,s,p,f,S,o,r,a,c,m,d,Dn,e),g.lineEnd=$,$()}return g}}var li=wn({point:function(t,n){this.stream.point(t*V,n*V)}});function ci(t){return wn({point:function(n,i){var e=t(n,i);return this.stream.point(e[0],e[1])}})}function ui(t,n,i,e,a){function o(r,c){return r*=e,c*=a,[n+t*r,i-t*c]}return o.invert=function(r,c){return[(r-n)/t*e,(i-c)/t*a]},o}function Xn(t,n,i,e,a,o){if(!o)return ui(t,n,i,e,a);var r=O(o),c=B(o),m=r*t,d=c*t,s=r/t,u=c/t,l=(c*i-r*n)/t,p=(c*n+r*i)/t;function f(S,g){return S*=e,g*=a,[m*S-d*g+n,i-d*S-m*g]}return f.invert=function(S,g){return[e*(s*S-u*g+l),a*(p-u*S-s*g)]},f}function ve(t){return di(function(){return t})()}function di(t){var n,i=150,e=480,a=250,o=0,r=0,c=0,m=0,d=0,s,u=0,l=1,p=1,f=null,S=Rn,g=null,L,v,y,$=dn,N=.5,b,T,C,M,A;function E(h){return C(h[0]*V,h[1]*V)}function k(h){return h=C.invert(h[0],h[1]),h&&[h[0]*Z,h[1]*Z]}E.stream=function(h){return M&&A===h?M:M=li(ci(s)(S(b($(A=h)))))},E.preclip=function(h){return arguments.length?(S=h,f=void 0,z()):S},E.postclip=function(h){return arguments.length?($=h,g=L=v=y=null,z()):$},E.clipAngle=function(h){return arguments.length?(S=+h?Be(f=h*V):(f=null,Rn),z()):f*Z},E.clipExtent=function(h){return arguments.length?($=h==null?(g=L=v=y=null,dn):De(g=+h[0][0],L=+h[0][1],v=+h[1][0],y=+h[1][1]),z()):g==null?null:[[g,L],[v,y]]},E.scale=function(h){return arguments.length?(i=+h,w()):i},E.translate=function(h){return arguments.length?(e=+h[0],a=+h[1],w()):[e,a]},E.center=function(h){return arguments.length?(o=h[0]%360*V,r=h[1]%360*V,w()):[o*Z,r*Z]},E.rotate=function(h){return arguments.length?(c=h[0]%360*V,m=h[1]%360*V,d=h.length>2?h[2]%360*V:0,w()):[c*Z,m*Z,d*Z]},E.angle=function(h){return arguments.length?(u=h%360*V,w()):u*Z},E.reflectX=function(h){return arguments.length?(l=h?-1:1,w()):l<0},E.reflectY=function(h){return arguments.length?(p=h?-1:1,w()):p<0},E.precision=function(h){return arguments.length?(b=Gn(T,N=h*h),z()):ht(N)},E.fitExtent=function(h,H){return me(E,h,H)},E.fitSize=function(h,H){return ei(E,h,H)},E.fitWidth=function(h,H){return ii(E,h,H)},E.fitHeight=function(h,H){return ai(E,h,H)};function w(){var h=Xn(i,0,0,l,p,u).apply(null,n(o,r)),H=Xn(i,e-h[0],a-h[1],l,p,u);return s=te(c,m,d),T=cn(n,H),C=cn(s,T),b=Gn(T,N),z()}function z(){return M=A=null,E}return function(){return n=t.apply(this,arguments),E.invert=n.invert&&k,w()}}function Mn(t,n){return[t,ke(Ce((J+n)/2))]}Mn.invert=function(t,n){return[t,2*Zn(_e(n))-J]};function ge(){return pi(Mn).scale(961/tt)}function pi(t){var n=ve(t),i=n.center,e=n.scale,a=n.translate,o=n.clipExtent,r=null,c,m,d;n.scale=function(u){return arguments.length?(e(u),s()):e()},n.translate=function(u){return arguments.length?(a(u),s()):a()},n.center=function(u){return arguments.length?(i(u),s()):i()},n.clipExtent=function(u){return arguments.length?(u==null?r=c=m=d=null:(r=+u[0][0],c=+u[0][1],m=+u[1][0],d=+u[1][1]),s()):r==null?null:[[r,c],[m,d]]};function s(){var u=F*e(),l=n(He(n.rotate()).invert([0,0]));return o(r==null?[[l[0]-u,l[1]-u],[l[0]+u,l[1]+u]]:t===Mn?[[Math.max(l[0]-u,r),c],[Math.min(l[0]+u,m),d]]:[[r,Math.max(l[1]-u,c)],[m,Math.min(l[1]+u,d)]])}return s()}function ye(t,n){var i=n*n,e=i*i;return[t*(.8707-.131979*i+e*(-.013791+e*(.003971*i-.001529*e))),n*(1.007226+i*(.015085+e*(-.044475+.028874*i-.005916*e)))]}ye.invert=function(t,n){var i=n,e=25,a;do{var o=i*i,r=o*o;i-=a=(i*(1.007226+o*(.015085+r*(-.044475+.028874*o-.005916*r)))-n)/(1.007226+o*(.015085*3+r*(-.044475*7+.028874*9*o-.005916*11*r)))}while(P(a)>R&&--e>0);return[t/(.8707+(o=i*i)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),i]};function fi(){return ve(ye).scale(175.295)}const Ln=[{id:"dashboard-nacional",label:"Dashboard Nacional",title:"Análisis de Participación Económica",subtitle:"Monitor de género y comparativa global",pill:"Participación Económica (Global)",sections:[{key:"participacion-global",type:"world-map-ranking",title:"Participación económica de las mujeres en el mundo",subtitle:"El país está por debajo del promedio mundial en participación económica de mujeres.",file:"data/dashboard-nacional/participacion_economica_mujeres_por_pais.json",layout:"map-ranking"},{key:"evolucion-tpe",type:"flourish-embed",title:"Dos de cada cinco mujeres participan en la economía en México",subtitle:"Evolución nacional histórica de la TPE (IMCO / INEGI)",file:"data/dashboard-nacional/participacion-mexico-historica.json",flourishId:"27259121"},{key:"brecha-salarial-genero",type:"line",title:"Evolución de la brecha salarial por género en México",subtitle:"Evolución porcentual nacional 2005 - 2025",file:"data/dashboard-nacional/evolucion_brecha_salarial_genero_mexico_fuente.json",width:"half",chartHeightScale:1.2},{key:"informalidad-laboral-sexo",type:"line",title:"Evolución de la informalidad laboral por sexo",subtitle:"Tasas trimestrales de ocupación informal 2005 - 2025",file:"data/dashboard-nacional/evolucion_informalidad_laboral_por_sexo_fuente.json",width:"half"},{key:"valor-cuidados",type:"stacked-bars",title:"Las mujeres aportan casi tres veces más valor económico por trabajo de cuidados",subtitle:"Evolución de la equivalencia del trabajo no remunerado en el PIB por sexo",file:"data/dashboard-nacional/valor_economico_cuidados_fuente.json"}]},{id:"estadisticas-entidad",label:"Estadísticas por Entidad",title:"Comparativo por Entidad Federativa",subtitle:"Indicadores clave para priorización territorial",pill:"Corte 2025",sections:[{key:"mapa-indicadores-entidad",type:"mexico-indicator-map",title:"Mapa de México por indicador",subtitle:"Selecciona un indicador y revisa su distribución por entidad federativa.",file:"data/estadisticas-entidad/variables_monitor_entidad_enriched.json",layout:"indicator-map"}]},{id:"cdmx-alcaldia",label:"CDMX por Alcaldía",title:"Panorama por Alcaldía en CDMX",subtitle:"Brecha e inclusión económica territorial",pill:"Alcaldías CDMX",sections:[{key:"mapa-indicadores-cdmx",type:"cdmx-indicator-map",title:"Mapa de CDMX por indicador",subtitle:"Selecciona un indicador para visualizar su comportamiento por alcaldía.",file:"data/cdmx-alcaldia/monitor_cdmx_indicadores.json",layout:"indicator-map"}]}],bt={women:"#6f4fe8",grid:"#ece9f8"},hi="https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson",mi="https://raw.githubusercontent.com/angelnmara/geojson/master/mexicoHigh.json",vi="data/cdmx-alcaldia/cdmx_alcaldias_real.geojson",gi="https://raw.githubusercontent.com/angelnmara/geojson/master/mexicoCityHigh.json",$t=typeof Intl<"u"&&Intl.DisplayNames?new Intl.DisplayNames(["es"],{type:"region"}):null,Un=typeof Intl<"u"&&Intl.DisplayNames?new Intl.DisplayNames(["en"],{type:"region"}):null,yi=ji(),be={brazil:"brasil",brasil:"brasil","united states":"estados unidos","united states of america":"estados unidos",usa:"estados unidos",us:"estados unidos",russia:"rusia","russian federation":"rusia",czechia:"republica checa","czech republic":"republica checa","ivory coast":"costa de marfil","democratic republic of the congo":"republica democratica del congo","republic of the congo":"republica del congo","south korea":"corea del sur","north korea":"corea del norte","lao pdr":"laos","lao peoples democratic republic":"laos","iran, islamic republic of":"iran","syrian arab republic":"siria","venezuela, bolivarian republic of":"venezuela","bolivia, plurinational state of":"bolivia","tanzania, united republic of":"tanzania","moldova, republic of":"moldavia",myanmar:"birmania",eswatini:"suazilandia","cape verde":"cabo verde",bahamas:"bahamas","the bahamas":"bahamas",slovakia:"eslovaquia","timor-leste":"timor oriental","brunei darussalam":"brunei","sao tome and principe":"santo tome y principe","north macedonia":"macedonia del norte",vietnam:"vietnam","viet nam":"vietnam"},bi={"estado de mexico":"mexico","mexico state":"mexico","ciudad de mexico":"ciudad de mexico","distrito federal":"ciudad de mexico",cdmx:"ciudad de mexico",veracruz:"veracruz de ignacio de la llave","coahuila de zaragoza":"coahuila",coahuila:"coahuila","michoacan de ocampo":"michoacan",michoacan:"michoacan"},$i={"gustavo a madero":"gustavo a madero","gustavo a. madero":"gustavo a madero","g a madero":"gustavo a madero",cuauhtemoc:"cuauhtemoc","magdalena contreras":"la magdalena contreras","la magdalena contreras":"la magdalena contreras","venustiano carranza":"venustiano carranza"},Bt={china:"republica popular china",chequia:"republica checa","estados unidos de america":"estados unidos",corea:"corea del sur",myanmar:"birmania","costa de marfil":"costa de marfil",suazilandia:"suazilandia",esuatini:"suazilandia",iran:"iran",lao:"laos",laos:"laos","cabo verde":"cabo verde","santo tome y principe":"santo tome y principe","macedonia del norte":"macedonia del norte",rusia:"rusia",siria:"siria",moldavia:"moldavia",tanzania:"tanzania",bolivia:"bolivia",venezuela:"venezuela","timor oriental":"timor oriental"},Wn=document.getElementById("tab-nav"),jt=document.getElementById("dashboard"),Si=document.getElementById("view-title"),Ei=document.getElementById("view-subtitle"),wi=document.getElementById("view-pill"),xi=document.getElementById("section-template");let _t=Ln[0].id;Mi();function Mi(){$e(),Se(_t)}function $e(){Wn.innerHTML="",Ln.forEach(t=>{const n=document.createElement("button");n.className=`tab-btn${t.id===_t?" active":""}`,n.textContent=t.label,n.type="button",n.onclick=()=>{_t!==t.id&&(_t=t.id,$e(),Se(_t))},Wn.appendChild(n)})}async function Se(t){const n=Ln.find(i=>i.id===t);if(n){Si.textContent=n.title,Ei.textContent=n.subtitle,wi.textContent=n.pill,jt.innerHTML='<article class="section card">Cargando secciones...</article>';try{const i=await Promise.all(n.sections.map(async e=>({section:e,data:Gi(e,await Ht(e.file))})));jt.innerHTML="";for(const{section:e,data:a}of i){const o=await Li(e,a);jt.appendChild(o)}}catch(i){jt.innerHTML=`<article class="section card">Error al cargar los datos: ${i.message}</article>`}}}async function Li(t,n){const i=xi.content.firstElementChild.cloneNode(!0);i.querySelector(".section-title").textContent=t.title,i.querySelector(".section-subtitle").textContent=t.subtitle;const e=i.querySelector(".section-body");return t.layout==="split"&&e.classList.add("split-body"),t.layout==="map-ranking"&&e.classList.add("map-ranking-body"),t.layout==="indicator-map"&&e.classList.add("indicator-map-body"),t.width==="half"&&i.classList.add("half"),t.type==="world-map-ranking"&&(e.innerHTML=await Ni(n),ki(e),_i(e)),t.type==="mexico-indicator-map"&&(e.innerHTML=Yn(),await Ci(e,n)),t.type==="cdmx-indicator-map"&&(e.innerHTML=Yn(),await zi(e,n)),t.type==="heat-ranking"&&(e.innerHTML=Oi(n)),t.type==="line"&&(e.innerHTML=Ne(n,{heightScale:t.chartHeightScale}),Kn(e)),t.type==="flourish-embed"&&(e.innerHTML=Xi(t),Ui()),t.type==="two-lines"&&(e.innerHTML=Bi(n),Kn(e)),t.type==="stacked-bars"&&(e.innerHTML=Vi(n,{variant:t.key==="valor-cuidados"?"care":"default",showAllXTicks:t.key==="valor-cuidados",yTicks:t.key==="valor-cuidados"?[0,8,16,30]:null,source:t.key==="valor-cuidados"?n.source:""}),Qn(e,".stack-segment")),t.type==="horizontal-bars"&&(e.innerHTML=Di(n),Qn(e,".horizontal-bar-fill")),i}async function Ni(t){var u;const n=Array.isArray(t)?t.filter(l=>l&&typeof l.tpe=="number").map(l=>({name:l.pais,value:l.tpe})):[];if(!n.length)return'<div class="chart-wrap">No hay datos disponibles para el mapa.</div>';const i=Math.min(...n.map(l=>l.value)),e=Math.max(...n.map(l=>l.value)),a=[...n].sort((l,p)=>p.value-l.value),o=new Map(n.map(l=>[K(l.name),l.value])),r=new Map(n.map(l=>[Sn(l.name),l.value])),c=new Map(n.map(l=>[K(l.name),l.name])),m=new Map(n.map(l=>[Sn(l.name),l.name]));let d=Ti(n,i,e);try{const l=await Ht(hi),p=l.features||((u=l==null?void 0:l.data)==null?void 0:u.features)||[];p.length&&(d=Ai(p,o,r,c,m,i,e))}catch{}const s=a.map((l,p)=>`<li><span>${p+1}. ${l.name}</span><strong>${l.value.toFixed(1)}%</strong></li>`).join("");return`
    <div class="map-panel chart-wrap">
      ${d}
      <div class="map-gradient">
        <span>0%</span>
        <div></div>
        <span>100%</span>
      </div>
    </div>
    <aside class="ranking">
      <h4>Ranking Internacional</h4>
      <ol class="rank-list">${s}</ol>
    </aside>
  `}function Ai(t,n,i,e,a,o,r){const d=t.filter(S=>{const g=Qt(S),L=K(g);return L!=="antarctica"&&L!=="antartida"}),s=fi().fitExtent([[8,8],[972,452]],{type:"FeatureCollection",features:d});s.scale(s.scale()*1.12);const[u,l]=s.translate();s.translate([u,l+12]);const p=En(s);return`<svg viewBox="0 0 980 460" class="chart-svg world-map-svg" role="img" aria-label="Mapa mundial de participación económica femenina">
    <rect x="0" y="0" width="980" height="460" fill="#f8f7fe" rx="14"></rect>
    ${d.map(S=>{const g=p(S);if(!g)return"";const L=Qt(S),v=Ri(L,S,n,i,e,a),y=(v==null?void 0:v.value)??null,$=(v==null?void 0:v.label)||qi(S,L),N=y===null?"#eceaf5":Jt(y,o,r);return y===null||`${$}${y.toFixed(1)}`,`<path d="${g}" fill="${N}" stroke="#ffffff" stroke-width="0.55" data-country="${I($)}" data-value="${y===null?"":y.toFixed(1)}"></path>`}).join("")}
  </svg>`}function _i(t){const n=t.querySelector(".world-map-svg");if(!n)return;const i=document.createElement("div");i.className="map-tooltip",i.hidden=!0,document.body.appendChild(i);const e=r=>{const c=r.target;if(!(c instanceof SVGPathElement)){i.hidden=!0;return}const m=c.dataset.country||"País",d=c.dataset.value;i.innerHTML=`
      <div class="map-tooltip-country">${I(m)}</div>
      <div class="map-tooltip-metric">Participación Económica (Global)</div>
      <div class="map-tooltip-value">${d?`${d}%`:"Sin dato"}</div>
    `,i.hidden=!1;const s=8,u=i.getBoundingClientRect();let l=r.clientX+s,p=r.clientY+s;l+u.width>window.innerWidth-6&&(l=r.clientX-u.width-s),p+u.height>window.innerHeight-6&&(p=r.clientY-u.height-s),i.style.left=`${l}px`,i.style.top=`${p}px`},a=()=>{i.hidden=!0},o=()=>{i.hidden=!0};n.addEventListener("mousemove",e),n.addEventListener("mouseleave",a),n.addEventListener("mouseout",o)}function ki(t){const n=t.querySelector(".map-panel"),i=t.querySelector(".ranking");if(!n||!i)return;const e=()=>{if(window.innerWidth<=1024){i.style.height="auto";return}const a=n.getBoundingClientRect().height;a>0&&(i.style.height=`${Math.round(a)}px`)};e(),typeof ResizeObserver<"u"?new ResizeObserver(()=>e()).observe(n):window.addEventListener("resize",e,{passive:!0})}function Ti(t,n,i){return`
    <div class="fallback-map" aria-label="Mapa simplificado de países por intensidad">
      ${t.sort((a,o)=>o.value-a.value).slice(0,48).map(a=>`<div class="fallback-cell" style="background:${Jt(a.value,n,i)}" title="${I(a.name)}: ${a.value.toFixed(1)}%"></div>`).join("")}
    </div>
  `}function Yn(){return`
    <div class="mexico-map-layout">
      <div class="chart-wrap mexico-map-wrap">
        <div class="mexico-map-toolbar">
          <label for="indicator-select">Indicador</label>
          <select id="indicator-select" class="indicator-select"></select>
          <div class="view-toggle" role="group" aria-label="Tipo de visualización">
            <button type="button" class="view-btn active" data-view="map">Mapa</button>
            <button type="button" class="view-btn" data-view="bars">Barras</button>
          </div>
        </div>
        <div class="mexico-map-stage">
          <svg class="chart-svg mexico-map-svg" role="img" aria-label="Mapa de México por entidad"></svg>
          <div class="bars-stage" hidden></div>
        </div>
        <div class="map-gradient">
          <span>Mín</span>
          <div></div>
          <span>Máx</span>
        </div>
      </div>
      <aside class="indicator-side">
        <h4 class="indicator-side-title"></h4>
        <div class="indicator-what-box">
          <h5>¿Qué mide?</h5>
          <p class="indicator-side-desc"></p>
        </div>
        <p class="indicator-side-meta"></p>
        <h5 class="indicator-side-subtitle">Top entidades</h5>
        <ol class="indicator-side-top"></ol>
        <section class="entity-profile-box">
          <p class="entity-profile-name"></p>
          <ul class="entity-profile-list"></ul>
        </section>
      </aside>
    </div>
  `}async function Ci(t,n){const e=(Array.isArray(n==null?void 0:n.data)?n.data:Array.isArray(n)?n:[]).filter(k=>k&&typeof k.Entidad=="string"&&typeof k.Variable=="string"&&Number.isFinite(k.Valor)),a=t.querySelector("#indicator-select"),o=t.querySelector(".mexico-map-svg"),r=t.querySelector(".bars-stage"),c=Array.from(t.querySelectorAll(".view-btn")),m=t.querySelector(".mexico-map-wrap"),d=t.querySelector(".indicator-side"),s=t.querySelector(".indicator-side-title"),u=t.querySelector(".indicator-side-desc"),l=t.querySelector(".indicator-side-meta"),p=t.querySelector(".indicator-side-top"),f=t.querySelector(".entity-profile-name"),S=t.querySelector(".entity-profile-list");if(!e.length||!a||!o||!r||!m||!d||!s||!u||!l||!p||!f||!S){t.innerHTML='<div class="chart-wrap">No hay datos disponibles para el mapa por entidad.</div>';return}let g;try{g=await Ht(mi)}catch{t.querySelector(".mexico-map-stage").innerHTML='<div class="chart-wrap">No fue posible cargar el mapa de México.</div>';return}const L=Ee(g);if(!L.length){t.querySelector(".mexico-map-stage").innerHTML='<div class="chart-wrap">El archivo del mapa no contiene entidades.</div>';return}const v=980,y=600,$=ge().fitExtent([[22,22],[v-22,y-22]],{type:"FeatureCollection",features:L}),N=En($),b=Zt(),T=Array.from(new Set(e.map(k=>k.Variable))).sort((k,w)=>k.localeCompare(w,"es")),C=T.find(k=>k==="Tasa de participación económica femenina")||T[0];a.innerHTML=T.map(k=>`<option value="${I(k)}">${I(k)}</option>`).join(""),a.value=C;let M="",A="map";const E=k=>{var at,St,Et,wt;const w=e.filter(_=>_.Variable===k),z=new Map(w.map(_=>[ut(_.Entidad),Number(_.Valor)])),h=w.map(_=>Number(_.Valor)),H=Math.min(...h),q=Math.max(...h),G=((at=w.find(_=>typeof _.Que_mide=="string"&&_.Que_mide.trim()))==null?void 0:at.Que_mide)||"Sin descripción.",X=((St=w.find(_=>typeof _.Unidad=="string"&&_.Unidad.trim()))==null?void 0:St.Unidad)||"Porcentaje",nt=X.toLowerCase().includes("porcent")?"%":X,D=w.slice().sort((_,x)=>x.Valor-_.Valor);(!M||!z.has(M))&&(M=D.length?ut(D[0].Entidad):"");const U=A==="map";if(Me(o,r,U),U){const _=L.map(x=>{const j=Qt(x),Y=ut(j),Q=z.get(Y),ct=Number.isFinite(Q)?Jt(Q,H,q):"#eceaf5",It=N(x);return It?`<path
          d="${It}"
          fill="${ct}"
          stroke="#ffffff"
          stroke-width="${Y===M?2.1:1}"
          class="${Y===M?"selected-state":""}"
          data-state-key="${I(Y)}"
          data-label="${I(Hi(j,w))}"
          data-value="${Number.isFinite(Q)?Q.toFixed(2):""}"
          data-unit="${I(nt)}"
        ></path>`:""}).join("");o.setAttribute("viewBox",`0 0 ${v} ${y}`),o.innerHTML=`<rect x="0" y="0" width="${v}" height="${y}" fill="#f8f7fe" rx="14"></rect>${_}`,r.innerHTML=""}else xe(r,D.map(_=>({key:ut(_.Entidad),label:_.Entidad,value:Number(_.Valor),unitSymbol:nt})),M,_=>{M=_,E(k)}),o.innerHTML="";s.textContent=k,u.textContent=G,l.textContent=`Cobertura: ${w.length} entidades | Unidad: ${X}`,p.innerHTML=D.map((_,x)=>{const j=ut(_.Entidad);return`<li class="${j===M?"active":""}" data-state-key="${I(j)}"><span>${x+1}. ${_.Entidad}</span><strong>${Number(_.Valor).toFixed(1)}${nt}</strong></li>`}).join("");const W=e.filter(_=>ut(_.Entidad)===M).slice().sort((_,x)=>_.Variable.localeCompare(x.Variable,"es")),st=((Et=W[0])==null?void 0:Et.Entidad)||((wt=D[0])==null?void 0:wt.Entidad)||"Entidad";f.textContent=st,S.innerHTML=W.map(_=>{const x=(_.Unidad||"").toLowerCase().includes("porcent")?"%":_.Unidad||"";return`<li><span class="entity-indicator-name">${_.Variable}</span><strong class="entity-indicator-value">${Number(_.Valor).toFixed(1)}${I(x)}</strong></li>`}).join(""),p.querySelectorAll("li[data-state-key]").forEach(_=>{_.addEventListener("click",()=>{M=_.dataset.stateKey||"",E(k)})}),U&&o.querySelectorAll("path[data-label]").forEach(_=>{_.addEventListener("mousemove",x=>{const j=_.dataset.label||"Entidad",Y=_.dataset.value,Q=_.dataset.unit||"";b.innerHTML=`
            <div class="chart-tooltip-title">${I(j)}</div>
            <div class="chart-tooltip-row">
              <span class="chart-tooltip-dot" style="background:#6f4fe8"></span>
              <span>${Y?`${Y}${I(Q)}`:"Sin dato"}</span>
            </div>
          `,b.hidden=!1,tn(b,x.clientX,x.clientY)}),_.addEventListener("click",()=>{M=_.dataset.stateKey||M,E(k)}),_.addEventListener("mouseleave",()=>{b.hidden=!0})})};c.forEach(k=>{k.addEventListener("click",()=>{A=k.dataset.view==="bars"?"bars":"map",c.forEach(w=>w.classList.toggle("active",w===k)),E(a.value)})}),a.addEventListener("change",()=>E(a.value)),E(C),we(m,d)}async function zi(t,n){const e=(Array.isArray(n==null?void 0:n.data)?n.data:Array.isArray(n)?n:[]).filter(w=>w&&typeof w.Entidad=="string"&&typeof w.Variable=="string"&&Number.isFinite(w.Valor)),a=t.querySelector("#indicator-select"),o=t.querySelector(".mexico-map-svg"),r=t.querySelector(".bars-stage"),c=Array.from(t.querySelectorAll(".view-btn")),m=t.querySelector(".mexico-map-wrap"),d=t.querySelector(".indicator-side"),s=t.querySelector(".indicator-side-title"),u=t.querySelector(".indicator-side-desc"),l=t.querySelector(".indicator-side-meta"),p=t.querySelector(".indicator-side-top"),f=t.querySelector(".indicator-side-subtitle"),S=t.querySelector(".entity-profile-name"),g=t.querySelector(".entity-profile-list");if(!e.length||!a||!o||!r||!m||!d||!s||!u||!l||!p||!f||!S||!g){t.innerHTML='<div class="chart-wrap">No hay datos disponibles para el mapa de alcaldías.</div>';return}f.textContent="Lista de alcaldías";let L;try{L=await Ht(vi)}catch{try{L=await Ht(gi)}catch{t.querySelector(".mexico-map-stage").innerHTML='<div class="chart-wrap">No fue posible cargar el mapa de CDMX.</div>';return}}const v=Ee(L);if(!v.length){t.querySelector(".mexico-map-stage").innerHTML='<div class="chart-wrap">El archivo del mapa no contiene alcaldías.</div>';return}const y=980,$=620,N=ge().fitExtent([[20,20],[y-20,$-20]],{type:"FeatureCollection",features:v}),b=En(N),T=Zt(),C=Array.from(new Set(e.map(w=>w.Variable))).sort((w,z)=>w.localeCompare(z,"es")),M=C.find(w=>w==="Delitos sexuales")||C[0];a.innerHTML=C.map(w=>`<option value="${I(w)}">${I(w)}</option>`).join(""),a.value=M;let A="",E="map";const k=w=>{var St,Et,wt,_;const z=e.filter(x=>x.Variable===w),h=new Map(z.map(x=>[dt(x.Entidad),Number(x.Valor)])),H=z.map(x=>Number(x.Valor)),q=Math.min(...H),G=Math.max(...H),X=((St=z.find(x=>typeof x.Que_mide=="string"&&x.Que_mide.trim()))==null?void 0:St.Que_mide)||"Sin descripción.",nt=((Et=z.find(x=>typeof x.Unidad=="string"&&x.Unidad.trim()))==null?void 0:Et.Unidad)||"Valor",D=nt.toLowerCase().includes("porcent")?"%":"",U=z.slice().sort((x,j)=>j.Valor-x.Valor);(!A||!h.has(A))&&(A=U.length?dt(U[0].Entidad):"");const W=E==="map";if(Me(o,r,W),W){const x=v.map(j=>{const Y=Qt(j),Q=dt(Y),ct=h.get(Q),It=Number.isFinite(ct)?Jt(ct,q,G):"#eceaf5",Nn=b(j);return Nn?`<path
          d="${Nn}"
          fill="${It}"
          stroke="#ffffff"
          stroke-width="${Q===A?2.1:1}"
          class="${Q===A?"selected-state":""}"
          data-state-key="${I(Q)}"
          data-label="${I(Ii(Y,z))}"
          data-value="${Number.isFinite(ct)?ct.toFixed(2):""}"
          data-unit="${I(D)}"
        ></path>`:""}).join("");o.setAttribute("viewBox",`0 0 ${y} ${$}`),o.innerHTML=`<rect x="0" y="0" width="${y}" height="${$}" fill="#f8f7fe" rx="14"></rect>${x}`,r.innerHTML=""}else xe(r,U.map(x=>({key:dt(x.Entidad),label:x.Entidad,value:Number(x.Valor),unitSymbol:D})),A,x=>{A=x,k(w)}),o.innerHTML="";s.textContent=w,u.textContent=X,l.textContent=`Cobertura: ${z.length} alcaldías | Unidad: ${nt}`,p.innerHTML=U.map((x,j)=>{const Y=dt(x.Entidad);return`<li class="${Y===A?"active":""}" data-state-key="${I(Y)}"><span>${j+1}. ${x.Entidad}</span><strong>${Number(x.Valor).toFixed(1)}${D}</strong></li>`}).join("");const st=e.filter(x=>dt(x.Entidad)===A).slice().sort((x,j)=>x.Variable.localeCompare(j.Variable,"es")),at=((wt=st[0])==null?void 0:wt.Entidad)||((_=U[0])==null?void 0:_.Entidad)||"Alcaldía";S.textContent=at,g.innerHTML=st.map(x=>{const j=(x.Unidad||"").toLowerCase().includes("porcent")?"%":"";return`<li><span class="entity-indicator-name">${x.Variable}</span><strong class="entity-indicator-value">${Number(x.Valor).toFixed(1)}${I(j)}</strong></li>`}).join(""),p.querySelectorAll("li[data-state-key]").forEach(x=>{x.addEventListener("click",()=>{A=x.dataset.stateKey||"",k(w)})}),W&&o.querySelectorAll("path[data-label]").forEach(x=>{x.addEventListener("mousemove",j=>{const Y=x.dataset.label||"Alcaldía",Q=x.dataset.value,ct=x.dataset.unit||"";T.innerHTML=`
            <div class="chart-tooltip-title">${I(Y)}</div>
            <div class="chart-tooltip-row">
              <span class="chart-tooltip-dot" style="background:#6f4fe8"></span>
              <span>${Q?`${Q}${I(ct)}`:"Sin dato"}</span>
            </div>
          `,T.hidden=!1,tn(T,j.clientX,j.clientY)}),x.addEventListener("click",()=>{A=x.dataset.stateKey||A,k(w)}),x.addEventListener("mouseleave",()=>{T.hidden=!0})})};c.forEach(w=>{w.addEventListener("click",()=>{E=w.dataset.view==="bars"?"bars":"map",c.forEach(z=>z.classList.toggle("active",z===w)),k(a.value)})}),a.addEventListener("change",()=>k(a.value)),k(M),we(m,d)}function Ee(t){var i;const n=(t==null?void 0:t.features)||((i=t==null?void 0:t.data)==null?void 0:i.features)||[];return Array.isArray(n)?n:[]}function ut(t){const n=K(t);return bi[n]||n}function Hi(t,n){const i=ut(t),e=n.find(a=>ut(a.Entidad)===i);return e?e.Entidad:t}function dt(t){const n=K(t);return $i[n]||n}function Ii(t,n){const i=dt(t),e=n.find(a=>dt(a.Entidad)===i);return e?e.Entidad:t}function we(t,n){const i=()=>{if(window.innerWidth<=1024){n.style.height="auto";return}const e=t.getBoundingClientRect().height;e>0&&(n.style.height=`${Math.round(e)}px`)};i(),typeof ResizeObserver<"u"?new ResizeObserver(()=>i()).observe(t):window.addEventListener("resize",i,{passive:!0})}function xe(t,n,i,e){const a=Math.max(...n.map(o=>o.value),1);t.className="bars-stage",t.innerHTML=`
    <div class="vbars-scroll">
      <div class="vbars-plot" style="--bar-count:${n.length}">
        ${n.map((o,r)=>{const c=o.value/a*100,m=o.key===i?"active":"",d=Fi(o.label);return`<button type="button" class="vbar-col ${m}" data-key="${I(o.key)}" title="${I(o.label)}">
            <strong class="vbar-value">${o.value.toFixed(1)}${I(o.unitSymbol)}</strong>
            <span class="vbar-track"><span class="vbar-fill" style="height:${c}%"></span></span>
            <span class="vbar-label">${r+1}. ${I(d)}</span>
          </button>`}).join("")}
      </div>
    </div>
  `,t.querySelectorAll("button[data-key]").forEach(o=>{o.addEventListener("click",()=>{e(o.dataset.key||"")})})}function Fi(t){const n=String(t||"").trim();if(n.length<=14)return n;const i=n.split(/\s+/).filter(Boolean);return i.length>=2?`${i[0]} ${i[1]}`:n.slice(0,14)}function Me(t,n,i){t.hidden=!i,n.hidden=i,t.style.display=i?"block":"none",n.style.display=i?"none":"grid"}function Qt(t){var n,i,e,a,o,r,c,m;return((n=t==null?void 0:t.properties)==null?void 0:n.name)||((i=t==null?void 0:t.properties)==null?void 0:i.NAME)||((e=t==null?void 0:t.properties)==null?void 0:e.NOMGEO)||((a=t==null?void 0:t.properties)==null?void 0:a.nomgeo)||((o=t==null?void 0:t.properties)==null?void 0:o.NOM_MUN)||((r=t==null?void 0:t.properties)==null?void 0:r.ADMIN)||((c=t==null?void 0:t.properties)==null?void 0:c.admin)||((m=t==null?void 0:t.properties)==null?void 0:m.sovereignt)||(t==null?void 0:t.id)||"País"}function Ri(t,n,i,e,a,o){const r=new Set,c=[t,...Pi(n)];for(const d of c){const s=K(d);if(!s)continue;r.add(s);const u=be[s];u&&r.add(K(u));const l=yi.get(s);l&&r.add(l)}const m=Le(n);if(m&&$t){const d=$t.of(m);if(d){const s=K(d);r.add(s),Bt[s]&&r.add(K(Bt[s]))}}for(const d of r){if(i.has(d))return{value:i.get(d),label:a.get(d)||t};const s=Bt[d];if(s&&i.has(K(s))){const l=K(s);return{value:i.get(l),label:a.get(l)||s}}const u=Sn(d);if(e.has(u))return{value:e.get(u),label:o.get(u)||t}}return null}function Pi(t){const n=(t==null?void 0:t.properties)||{},i=["name","NAME","ADMIN","admin","sovereignt","SOVEREIGNT","name_long","NAME_LONG","formal_en","FORMAL_EN","name_sort","NAME_SORT","abbrev","ABBREV","postal","POSTAL","brk_name","BRK_NAME"],e=[];for(const a of i){const o=n[a];typeof o=="string"&&o.trim()&&e.push(o.trim())}return e}function qi(t,n){const i=Le(t);if(i&&$t){const o=$t.of(i);if(o){const r=K(o);return Bt[r]||o}}const e=K(n),a=be[e];return a||n}function Le(t){const n=(t==null?void 0:t.properties)||{},i=[n.iso_a2,n.ISO_A2,n.iso2,n.ISO2,n["iso-a2"]];for(const e of i)if(typeof e=="string"&&/^[A-Z]{2}$/.test(e.toUpperCase()))return e.toUpperCase();return null}function K(t){return String(t||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim()}function ji(){const t=new Map;if(!Un||!$t)return t;for(let n=0;n<26;n+=1)for(let i=0;i<26;i+=1){const e=String.fromCharCode(65+n)+String.fromCharCode(65+i),a=Un.of(e),o=$t.of(e);!a||!o||t.set(K(a),K(o))}return t}function Sn(t){return K(t).replace(/\b(the|of|and|republic|islamic|democratic|federal|state|states|kingdom|people|peoples|plurinational)\b/g," ").replace(/\b(el|la|los|las|de|del|y|republica|popular|democratica|federacion|estado|estados|unida|unidas)\b/g," ").replace(/\s+/g," ").trim()}function Jt(t,n,i){return`rgba(111, 79, 232, ${(.2+(t-n)/(i-n||1)*.75).toFixed(3)})`}function I(t){return String(t).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function Oi(t){const n=Math.min(...t.items.map(o=>o.value)),i=Math.max(...t.items.map(o=>o.value)),e=t.items.map(o=>{const c=`rgba(111, 79, 232, ${.15+(o.value-n)/(i-n||1)*.8})`;return`<div class="heat-item">
      <strong>${o.name}</strong>
      <small>${o.value.toFixed(1)}${t.unit}</small>
      <div class="heat-bar" style="background:${c}"></div>
    </div>`}).join(""),a=t.ranking.map((o,r)=>`<li><span>${r+1}. ${o.name}</span><strong>${o.value.toFixed(1)}${t.unit}</strong></li>`).join("");return`
    <div class="chart-wrap">
      <div class="heat-grid">${e}</div>
    </div>
    <aside class="ranking">
      <h4>${t.rankingTitle}</h4>
      <ol class="rank-list">${a}</ol>
    </aside>
  `}function Ne(t,n={}){const i=window.innerWidth<=760,e=t.labels,a=t.series,o=a.flatMap(b=>b.values),r=t.min??Math.min(...o),c=t.max??Math.max(...o),m=t.unit||"",d=n.heightScale??1,s=i?680:920,u=Math.round((i?360:320)*d),l=i?{top:18,right:14,bottom:46,left:42}:{top:20,right:20,bottom:45,left:50},p=s-l.left-l.right,f=u-l.top-l.bottom,S=b=>l.left+p*b/(e.length-1||1),g=b=>l.top+f-(b-r)*f/(c-r||1),L=Array.from({length:5},(b,T)=>{const C=r+(c-r)/4*T,M=g(C);return`<line x1="${l.left}" y1="${M}" x2="${s-l.right}" y2="${M}" stroke="${bt.grid}" />
      <text x="10" y="${M+4}" font-size="11" fill="#7b809a">${C.toFixed(0)}${t.unit||""}</text>`}).join(""),v=Math.ceil(i?e.length/5:e.length/10),y=e.map((b,T)=>T%v!==0&&T!==e.length-1?"":`<text x="${S(T)}" y="${u-10}" font-size="11" fill="#7b809a" text-anchor="middle">${b}</text>`).join(""),$=a.map(b=>{const T=b.values.map((A,E)=>`${E===0?"M":"L"}${S(E)},${g(A)}`).join(" "),C=b.values.map((A,E)=>`
      <circle cx="${S(E)}" cy="${g(A)}" r="4.2" fill="${b.color}" class="line-point" />
      <circle
        cx="${S(E)}"
        cy="${g(A)}"
        r="13.5"
        fill="transparent"
        class="line-hit"
        data-label="${I(e[E])}"
        data-series="${I(b.name)}"
        data-value="${A.toFixed(2)}"
        data-unit="${I(m)}"
        data-color="${b.color}"
        data-cx="${S(E)}"
      />
    `).join(""),M=b.values.length-1;return`
      <path d="${T}" fill="none" stroke="${b.color}" stroke-width="3" stroke-linecap="round"/>
      ${C}
      <text x="${S(M)+8}" y="${g(b.values[M])}" fill="${b.color}" font-size="12" font-weight="700">${b.name} ${b.values[M].toFixed(1)}${m}</text>
    `}).join(""),N=a.map(b=>`<span><span class="legend-dot" style="background:${b.color}"></span>${b.name}</span>`).join("");return`
    <div class="chart-wrap line-chart-wrap" data-chart-kind="line">
      <svg
        viewBox="0 0 ${s} ${u}"
        class="chart-svg"
        role="img"
        aria-label="Gráfica de líneas"
        data-guide-top="${l.top}"
        data-guide-bottom="${u-l.bottom}"
      >
        ${L}
        ${$}
        ${y}
      </svg>
    </div>
    <div class="chart-legend">${N}</div>
  `}function Bi(t){return`<div class="two-col">${t.charts.map(i=>`
    <div class="chart-wrap">
      <h4 style="margin:.1rem 0 .2rem; font-size:.95rem;">${i.title}</h4>
      <p style="margin:0 0 .45rem; color:#7b809a; font-size:.8rem;">${i.subtitle}</p>
      ${Ne(i)}
    </div>
  `).join("")}</div>`}function Vi(t,n={}){const i=t.labels,e=t.series,a=t.max??Math.max(...i.map((v,y)=>e.reduce(($,N)=>$+N.values[y],0))),o=920,r=330,c={top:20,right:20,bottom:45,left:40},m=o-c.left-c.right,d=r-c.top-c.bottom,s=m/i.length*.65,u=v=>c.top+d-v*d/(a||1),l=i.map((v,y)=>{const $=c.left+m/i.length*y+(m/i.length-s)/2;let N=0;const b=e.map(A=>{const E=A.values[y],k=u(N+E),w=d-(k-c.top)-N*d/(a||1);return N+=E,`<rect
        x="${$}"
        y="${k}"
        width="${s}"
        height="${w}"
        rx="4"
        fill="${A.color}"
        opacity="0.9"
        class="stack-segment"
        data-label="${I(v)}"
        data-series="${I(A.name)}"
        data-value="${E.toFixed(2)}"
        data-unit="${I(t.unit||"")}"
        data-color="${A.color}"
      />`}).join(""),T=window.innerWidth<=760,C=n.showAllXTicks?T?2:1:Math.ceil(i.length/10),M=y%C===0||y===i.length-1?`<text x="${$+s/2}" y="${r-10}" text-anchor="middle" font-size="11" fill="#7b809a">${v}</text>`:"";return b+M}).join(""),f=(Array.isArray(n.yTicks)&&n.yTicks.length?n.yTicks:Array.from({length:5},(v,y)=>a/4*y)).map(v=>{const y=u(v);return`<line x1="${c.left}" y1="${y}" x2="${o-c.right}" y2="${y}" stroke="${bt.grid}"/>
      <text x="6" y="${y+4}" font-size="11" fill="#7b809a">${v.toFixed(0)}${t.unit||""}</text>`}).join(""),S=e.map(v=>`<span><span class="legend-dot" style="background:${v.color}"></span>${v.name}</span>`).join(""),g=n.variant==="care"?`<div class="care-top-legend">${e.map(v=>`<span><span class="legend-dot square" style="background:${v.color}"></span>${v.name.replace("Aporte ","").toUpperCase()}</span>`).join("")}</div>`:"",L=n.variant==="care"?`<div class="care-footer"><small>${I(n.source||"")}</small></div>`:`<div class="chart-legend">${S}</div>`;return`
    <div class="chart-wrap ${n.variant==="care"?"care-stacked-wrap":""}">
      ${g}
      <svg viewBox="0 0 ${o} ${r}" class="chart-svg" role="img" aria-label="Gráfica de barras apiladas">
        ${f}
        ${l}
      </svg>
    </div>
    ${L}
  `}function Di(t){const n=t.max??Math.max(...t.items.map(e=>e.value));return`<div class="chart-wrap horizontal-bars-wrap">${t.items.map(e=>{const a=e.value/n*100;return`<div class="horizontal-bar-row" style="display:grid; grid-template-columns: 180px 1fr 70px; gap:.7rem; align-items:center; margin:.45rem 0;">
      <span style="font-size:.86rem;">${e.name}</span>
      <div style="height:10px; background:#eeebfb; border-radius:999px; overflow:hidden;">
        <div
          class="horizontal-bar-fill"
          style="height:100%; width:${a}%; background:${e.color||bt.women}; border-radius:999px;"
          data-label="${I(e.name)}"
          data-value="${e.value.toFixed(2)}"
          data-unit="${I(t.unit||"")}"
          data-color="${e.color||bt.women}"
        ></div>
      </div>
      <strong style="font-size:.85rem; text-align:right;">${e.value.toFixed(1)}${t.unit||""}</strong>
    </div>`}).join("")}</div>`}function Kn(t){const n=t.querySelectorAll('.chart-wrap[data-chart-kind="line"]');if(!n.length)return;const i=Zt();n.forEach(e=>{const a=e.querySelector("svg");if(!a)return;const o=document.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("class","line-hover-guide"),o.setAttribute("y1",a.dataset.guideTop||"20"),o.setAttribute("y2",a.dataset.guideBottom||"275"),o.setAttribute("visibility","hidden"),a.appendChild(o);const r=e.querySelectorAll(".line-hit");r.forEach(c=>{c.addEventListener("mousemove",m=>{const d=c.dataset.label||"",s=c.dataset.unit||"",u=c.dataset.cx||"0";o.setAttribute("x1",u),o.setAttribute("x2",u),o.setAttribute("visibility","visible");const p=Array.from(r).filter(f=>f.dataset.label===d).map(f=>{const S=f.dataset.series||"",g=Number(f.dataset.value||0);return`
            <div class="chart-tooltip-row">
              <span class="chart-tooltip-dot" style="background:${f.dataset.color||bt.women}"></span>
              <span>${I(S)}: ${g.toFixed(1)}${I(s)}</span>
            </div>
          `}).join("");i.innerHTML=`
          <div class="chart-tooltip-title">${I(d)}</div>
          ${p}
        `,i.hidden=!1,tn(i,m.clientX,m.clientY)}),c.addEventListener("mouseleave",()=>{o.setAttribute("visibility","hidden"),i.hidden=!0})})})}function Qn(t,n){const i=t.querySelectorAll(n);if(!i.length)return;const e=Zt();i.forEach(a=>{a.addEventListener("mousemove",o=>{const r=a.dataset.label||"",c=a.dataset.series||"",m=Number(a.dataset.value||0),d=a.dataset.unit||"",s=a.dataset.color||bt.women;e.innerHTML=`
        <div class="chart-tooltip-title">${I(r)}</div>
        <div class="chart-tooltip-row">
          <span class="chart-tooltip-dot" style="background:${s}"></span>
          <span>${I(c?`${c}: `:"")}${m.toFixed(1)}${I(d)}</span>
        </div>
      `,e.hidden=!1,tn(e,o.clientX,o.clientY)}),a.addEventListener("mouseleave",()=>{e.hidden=!0})})}function Zt(){let t=document.getElementById("chart-tooltip");return t||(t=document.createElement("div"),t.id="chart-tooltip",t.className="chart-tooltip",t.hidden=!0,document.body.appendChild(t),t)}function tn(t,n,i){const a=t.getBoundingClientRect();let o=n+10,r=i+10;o+a.width>window.innerWidth-6&&(o=n-a.width-10),r+a.height>window.innerHeight-6&&(r=i-a.height-10),t.style.left=`${o}px`,t.style.top=`${r}px`}async function Ht(t){const n=await fetch(t);if(!n.ok)throw new Error(`No se pudo leer ${t}`);return n.json()}function Gi(t,n){var i,e,a;if(t.key==="brecha-salarial-genero"&&((i=n==null?void 0:n.sheets)!=null&&i.Hoja1)){const o=n.sheets.Hoja1.filter(r=>Number.isFinite(r==null?void 0:r.Año)&&Number.isFinite(r==null?void 0:r.Brecha));return{unit:"%",min:0,max:24,labels:o.map(r=>String(r.Año)),series:[{name:"Brecha Salarial",color:"#ec4899",values:o.map(r=>+(r.Brecha*100).toFixed(2))}]}}if(t.key==="informalidad-laboral-sexo"&&((e=n==null?void 0:n.sheets)!=null&&e.Hoja1)){const o=n.sheets.Hoja1.filter(r=>typeof(r==null?void 0:r.Trimestre)=="string"&&Number.isFinite(r==null?void 0:r.Mujeres)&&Number.isFinite(r==null?void 0:r.Hombres));return{unit:"%",min:0,max:65,labels:o.map(r=>r.Trimestre),series:[{name:"Mujeres",color:"#6f4fe8",values:o.map(r=>+(r.Mujeres*100).toFixed(2))},{name:"Hombres",color:"#90a0bd",values:o.map(r=>+(r.Hombres*100).toFixed(2))}]}}if(t.key==="valor-cuidados"&&((a=n==null?void 0:n.sheets)!=null&&a.Hoja1)){const o=n.sheets.Hoja1.filter(r=>Number.isFinite(r==null?void 0:r.Año)&&Number.isFinite(r==null?void 0:r.Mujeres)&&Number.isFinite(r==null?void 0:r.Hombres));return{unit:"%",max:32,source:"Fuente: Cuentas Satélite de Trabajo No Remunerado (INEGI)",labels:o.map(r=>String(r.Año)),series:[{name:"Aporte Mujeres",color:"#6f4fe8",values:o.map(r=>+(r.Mujeres*100).toFixed(2))},{name:"Aporte Hombres",color:"#ff7b53",values:o.map(r=>+(r.Hombres*100).toFixed(2))}]}}return n}function Xi(t){const n=t.flourishId||"";return`
    <div class="chart-wrap flourish-wrap">
      <div class="flourish-embed flourish-chart" data-src="visualisation/${n}">
        <noscript>
          <img src="https://public.flourish.studio/visualisation/${n}/thumbnail" width="100%" alt="chart visualization" />
        </noscript>
      </div>
    </div>
  `}function Ui(){const t=document.querySelector('script[data-flourish-embed-script="true"]');t&&t.remove();const n=document.createElement("script");n.src="https://public.flourish.studio/resources/embed.js",n.async=!0,n.dataset.flourishEmbedScript="true",document.body.appendChild(n)}
